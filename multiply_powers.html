<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Probabily and stadistics formulas</title>
  <meta name="description" content="Probabily and stadistics formulas">
  <meta name="author" content="Jorge Ferreiro">

  <link rel="stylesheet" href="style.css"> 
  <link rel="stylesheet" href="http://gregfranko.com/jquery.selectBoxIt.js/css/jquery.selectBoxIt.css" />
</head>

<body>


    <div class="fixedPannel fixedPannel-left">
      

      <div class="addonBox" id="binomial">
        <iframe width="100%" height="260px" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="binomial.html#content">
        </iframe>
      </div> 

      <div class="addonBox" id="binomial">
        <iframe width="100%" height="250px" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="laplace_rules.html#content">
        </iframe>
      </div>  
    </div>


    <div class="fixedPannel fixedPannel-right">
       
      <div class="addonBox" id="factorial">
        <iframe width="100%" height="140px" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="factorial.html#content">
        </iframe>
      </div> 

    </div>

    <div id="content">

        <h2>
            Make a <span id="currentOperationTitle" style="display:none;"></span>
             <select id="operation" name="changeOperation" >
              <option value='*'>(*) Multiplication</option>
              <option value='/'>(/) Division</option>
              <option value='+'>(+) Addition</option>
              <option value='-'>(-) Substract</option>
            </select>
            <p class="clear" onclick="clearAllInputs(); return false;">clear</p>

        </h2>

        <form name="multiply_powers"> 
 
          <p>First operator:</p>
          <input type='text' id="number1" placeholder="Valor" />
          <input type='text' id="number2" placeholder="Potencia" />

          <p>Second operator:</p>
          <input type='text' id="number3" placeholder="Valor" />
          <input type='text' id="number4" placeholder="Potencia" />

          <p>Third operator operator:</p>
          <input type='text' id="number5" placeholder="Valor" />
          <input type='text' id="number6" placeholder="Potencia" />

        </form>

        <div class="result" id="result">
            <p>Result <b><span id="resultValue"></span></b></p>
        </div>
    
    </div>
    
 

    <script type="text/javascript"> 

     // Binomial coefficient
     // Credits: github.com/jgferreiro

     setInterval(function(){ 
         updateResult();        
     }, 300);


     function updateResult() {
        updateInputsArrays(); // Actualizar array con los nuevos valores de base y potencia para cada input.
        newResult = calculateTotal(); // Calculate the new Result.
        updatingResults(newResult);
     }


     // Clear all the inputs for the calculator

     function clearAllInputs() {
        var inputs = document.getElementsByTagName('input');

        for (var i = 0; i < inputs.length; i++) {
          inputs[i].value = "";
        }
     }

     var currentOperation = "*"; // Multiplication is the default operation

     // Creating the arrays where storing the new values for the inputs.

     var inputsArr;  // bidimensional array where row is individual fields and rows are (value and power) 
     var inputs = document.getElementsByTagName('input');
     createInputsArrays();

     function createInputsArrays() {

        inputsArr = new Array(); // Each position of the array correspond to each input. Where [0] = input1 | [1] = input1Power | [2] = input2 | [3] = input2_power

        // Keeping each inputs on a bidimensional array. 
        // Each row represents the input with power of the form [0][0] = input1 | [0][1] = input1Power
        // currentRow = 0;

        for (var i = 0; i < inputs.length; i++) {
            var inputValue = inputs[i].value;
            var currentRow = currentRow || 0;
            if (i % 2 == 0) {
              inputsArr[currentRow] = new Array(); // Create a "column" array.
              inputsArr[currentRow][0] = inputValue;
            }
            else {
              inputsArr[currentRow][1] = inputValue; // Save the input value on the array... First position is the input value, second the power.
              currentRow++; // Go to the next row.
            }        

        }
        console.log(inputsArr);
     }

     // Traverse all the inputs for the webpage. And save the result in the corresponding array.

     function updateInputsArrays() {
        for (var i = 0; i < inputsArr.length; i++) {
            var inputsField = inputsArr[i]; // Input field is composed by number and power.
            for (var j = 0; j < inputsArr[i].length; j++) {
                var inputNumber = 'number'+ (i + j); // example: number1: takes the value for the input.
                console.log(inputNumber);
                var value = document.getElementById(inputNumber).value;

                if (value == "") value = 1; // power input is not filled. We assume 1 by default.
                if (value == "e") value = 2.718281828;

                if (value != inputsField[j]) {
                   inputsField[j] = value; // Saving the current element to the column if the value has changed.
                }
            }
        }
     }

     // Changing the view with the new result. Updates it content

     function updatingResults(newResult) {
        var previousResult = document.getElementById('resultValue').innerHTML;

        if (newResult != previousResult) result.classList.add("resultChanged");
        else result.classList.remove("resultChanged");
        document.getElementById('resultValue').innerHTML = newResult; // Changing the text with the new result.
     }

     // Returns an array of powers, where each index is the power of base and p. 
     function calculatePowers(inputsArr) {
        p = new Array();

        for (var i = 0; i < inputsArr.length; i++) {
           pow = Math.pow(inputsArr[i][0], inputsArr[i][1]); // base number | power.
           p.push(pow);
        }

        return p; // Array of powers
     }

     // Caculate the total result (add, substrac, multiply). For our inputs Arr.

     function calculateTotal() {
        e = document.getElementById('operation'); // Get the current operation with the option select.
        operation = e.options[e.selectedIndex].value;

        // updateTitleWithOperation(operation); // update web title with current operation

        if (currentOperation != operation) {
            clearAllInputs(); // Clear all the inputs for the calculator
            currentOperation = operation; // Update the current operation with the new one.
            document.getElementById('resultValue').innerHTML = total;
            return; // exit this function
        }

        // Powers array
        var powers = calculatePowers(inputsArr);
        total = 1;

        for (var i = 0; i < powers.length; i++) {
            if (operation == '*' || operation == 'x') {
                total *= powers[i]; // a * b * c
            }
            else if (operation == '+' || operation == 'sum') {
                total += powers[i];
            }
            else if (operation == '-' || operation == 'sub') {
                total -= powers[i];
            }
            else if (operation == '/' || operation == 'div') {
                total /= powers[i];
            }
        }
        
        return total;  
     }

    </script>




    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <script src="http://gregfranko.com/jquery.selectBoxIt.js/js/jquery.selectBoxIt.min.js"></script>
    <script>
      $(function() {

        var selectBox = $("select").selectBoxIt();

      });
    </script>


</body>
</html>